<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.neusoft.ssmpro.mapper.CategoryVMapper">
	<resultMap id="BaseResultMap" type="com.neusoft.ssmpro.entity.CategoryV">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		<id column="categoryv_id" jdbcType="INTEGER" property="categoryvId" />
		<result column="categoryv_no" jdbcType="INTEGER" property="categoryvNo" />
		<result column="categoryv_name" jdbcType="VARCHAR" property="categoryvName" />
		<result column="categoryv_status" jdbcType="CHAR" property="categoryvStatus" />
		<result column="categorynavid" jdbcType="INTEGER" property="categorynavid" />
		<result column="categoryv_ctime" jdbcType="TIMESTAMP" property="categoryvCtime" />
	</resultMap>

	<select id="loadFirstNavVIds" resultType="Integer">
		select categoryv_id
		from tbl_category_v  v ,(select categorynavid  cid,
		min(categoryv_no) no from tbl_category_v group by categorynavid ) m where v.categoryv_status=1 and
		v.categoryv_no=m.no and v.categorynavid=m.cid  order
		by v.categoryv_id asc
	</select>


	<delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		delete from tbl_category_v
		where categoryv_id =
		#{categoryvId,jdbcType=INTEGER}
	</delete>
	<insert id="insert" parameterType="com.neusoft.ssmpro.entity.CategoryV">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		insert into tbl_category_v (categoryv_id, categoryv_no,
		categoryv_name,
		categoryv_status, categorynavid, categoryv_ctime
		)
		values (#{categoryvId,jdbcType=INTEGER},
		#{categoryvNo,jdbcType=INTEGER},
		#{categoryvName,jdbcType=VARCHAR},
		#{categoryvStatus,jdbcType=CHAR}, #{categorynavid,jdbcType=INTEGER},
		#{categoryvCtime,jdbcType=TIMESTAMP}
		)
	</insert>
	<update id="updateByPrimaryKey" parameterType="com.neusoft.ssmpro.entity.CategoryV">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		update tbl_category_v
		set categoryv_no =
		#{categoryvNo,jdbcType=INTEGER},
		categoryv_name =
		#{categoryvName,jdbcType=VARCHAR},
		categoryv_status =
		#{categoryvStatus,jdbcType=CHAR},
		categorynavid =
		#{categorynavid,jdbcType=INTEGER},
		categoryv_ctime =
		#{categoryvCtime,jdbcType=TIMESTAMP}
		where categoryv_id =
		#{categoryvId,jdbcType=INTEGER}
	</update>
	<select id="selectByPrimaryKey" parameterType="java.lang.Integer"
		resultMap="BaseResultMap">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		select categoryv_id, categoryv_no, categoryv_name, categoryv_status,
		categorynavid,
		categoryv_ctime
		from tbl_category_v
		where categoryv_id =
		#{categoryvId,jdbcType=INTEGER}
	</select>
	<select id="selectAll" resultMap="BaseResultMap">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		select categoryv_id, categoryv_no, categoryv_name, categoryv_status,
		categorynavid,
		categoryv_ctime
		from tbl_category_v
	</select>

	<select id="loadCategoryVByNavId" resultType="CategoryV">
		select * from
		tbl_category_v where categorynavid=#{id} and
		categoryv_status=1 order
		by categoryv_no limit 0,5
	</select>

	<select id="loadAllCategoryVByNavId" resultType="CategoryV">
		select * from
		tbl_category_v where categorynavid=#{id} and
		categoryv_status=1 order
		by categoryv_no
	</select>

	<select id="listbypage" resultType="CategoryV">
		select * from tbl_category_v where categorynavid=#{id} order by categoryv_id desc 
	</select> 
	
	<select id="loadTreeNodeByNavId" resultType="ZtreeVo">
		select categoryv_id id ,categoryv_name name ,categorynavid pid  from
		tbl_category_v where categorynavid=#{id} order by categoryv_no
	</select>
	
	<update id="updateNode">
		update tbl_category_v set categoryv_name=#{name}  where categoryv_id=#{id}
	</update>
	
	<update id="changeCategoryNav">
		update tbl_category_v set categorynavid =#{pid} where categoryv_id=#{id}
	</update>
	
	<insert id="addNode" useGeneratedKeys="true" keyProperty="id">
		insert into tbl_category_v (categoryv_name, categorynavid) values (#{name},#{pid})
	</insert>
</mapper>